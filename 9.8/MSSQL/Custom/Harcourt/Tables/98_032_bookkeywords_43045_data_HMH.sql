
DECLARE @v_bookkey_from INT,
		@v_bookkey_to INT,
		@v_error_desc varchar(2000),
		@error_var    INT,
        @rowcount_var INT
		
		SET @v_error_desc = ''
		
DECLARE work_cur CURSOR FOR
	SELECT DISTINCT propagatefrombookkey, bookkey FROM book where bookkey IN 
	(
	6602119	,
	6630128	,
	6630434	,
	16719136,
	6919193	,
	35114424,
	45523354,
	6630167	,
	42469967,
	32926859,
	41643891,
	23349811,
	42472221,
	32358877,
	24147458,
	6629891,
	42472055,
	27121083,
	10815657,
	39301396,
	8744468,
	17123983,
	12154501,
	17358273,
	14016058,
	33687733,
	17359147,
	11309277,
	24656057,
	20031976,
	6631852,
	24235250	,
	24044994	,
	24045300	,
	6630131	,
	21403477	,
	2079652	,
	6300512	,
	5155113	,
	24163698	,
	6631304	,
	42470133	,
	20794739	,
	9935709	,
	8699973	,
	8834408	,
	9671934	,
	24372557	,
	41640122	,
	6630713	,
	41645731	,
	42472343	,
	26516175	,
	9935705	,
	6631952	,
	2080444	,
	41640694	,
	6919538	,
	6011776	,
	18157580	,
	5386195	,
	41639938	,
	6919553	,
	6636990	,
	27744808	,
	9935769	,
	9936118	,
	6919583	,
	6630542	,
	6919601	,
	7168723	,
	1458508	,
	25113546	,
	26878867	,
	6919607	,
	558028	,
	622681	,
	6919649	,
	33110772	,
	6010567	,
	7865213	,
	41643335	,
	15501846	,
	16847359	,
	2080897	,
	6011404	,
	41640509	,
	6010597	,
	2036563	,
	2036569	,
	2080429	,
	8781888	,
	23520876	,
	32047622	,
	6013176	,
	32044662	,
	41641847	,
	41642030	,
	39370306	,
	5173459	,
	6300608	,
	41643708	,
	6632241	,
	8925813	,
	2081134	,
	6100529	,
	6300448	,
	6631421	,
	9936110	,
	6919733	,
	4109021	,
	6300480	,
	43294147	,
	24681686	,
	6221695	,
	6300675	,
	31314160	,
	2082433	,
	2082445	,
	23226179	,
	6919928	,
	6012900	,
	2072203	,
	9394957	,
	2071939	,
	2072569	,
	2082367	,
	6631238	,
	35115307	,
	21030582	,
	23773397	,
	6630536	,
	5446030	,
	5418686	,
	6919676	,
	23170144	,
	45017580	,
	8712445	,
	8837194	,
	41575835	,
	25028923	,
	2071948	,
	6631127	,
	6920087	,
	546322	,
	42469476	,
	23938642	,
	6920159	,
	36740634	,
	24253685	,
	24253992	,
	27616232	,
	6630851	,
	13007622	,
	6920240	,
	41642957	,
	6920285	,
	41642581	,
	24705417	,
	41641256	,
	41643148	,
	21420649	,
	25020241	,
	23656918	,
	23657196	,
	6920390	,
	1106964	,
	9102960	,
	9936584	,
	41643518	,
	24527729	,
	20167745	,
	41644095	,
	41644955	,
	42887124	,
	23926215	,
	23926493	,
	42470630	,
	23827324	,
	23827679	,
	42469789	,
	42471298	,
	6920621	,
	6920624	,
	2028964	,
	2033371	,
	4649240	,
	6010690	,
	10973512	,
	23973235	,
	2035642	,
	2030050	,
	2029069	,
	3810251	,
	2030659	,
	2082124	,
	13773109	,
	42471754	,
	36199621	,
	38700223	,
	6920738	,
	6630662	,
	2065993	,
	12513219	,
	26902760	,
	39374983	,
	6920825	,
	25181626	,
	42471417	,
	41646531	,
	6920858	,
	16623356	,
	6629837	,
	30811983	,
	6630320	,
	36199813	,
	42471564	,
	27402813	,
	42334295	,
	6921008	,
	546587	,
	26133512	,
	30810867	,
	8011796	,
	622143	,
	24482954	,
	18051453	,
	2036287	,
	6300298	,
	30874726	,
	31493428	,
	41640906	,
	38767008	,
	24790560	,
	33619750	,
	38700908	,
	42472508	,
	42469171	,
	21017728	,
	6300382	,
	41180312	,
	6631277	,
	11594851	,
	42470925	,
	35114804	,
	6630752	,
	35815984	,
	25028005	,
	41645235	,
	6630158	,
	6632508	,
	2083414	,
	39370828	,
	41641088	,
	6011680	,
	7553257	,
	42471902	,
	42469644	,
	19647201	,
	41640307	,
	42473076	,
	6921674	,
	64948	,
	431553	,
	431553	,
	9103309	,
	10407917	,
	6631226	,
	9937444	,
	6631346	,
	2080252	,
	23957217	,
	6921794	,
	6921815	,
	6921836	,
	42470264	,
	41644279	,
	45522154	,
	8835063	,
	8708254	,
	4649697	,
	6010969	,
	2030656	,
	2028979	,
	2032717	,
	10971523	,
	6409285	,
	2030044	,
	2029030	,
	3805620	,
	2037331	,
	19919976	,
	9265589	,
	6632399	,
	6632381	,
	31067552	,
	41645916	,
	41642768	,
	40647836	,
	9937684	,
	6011821	,
	2081149	,
	8012807	,
	43294850	,
	34762590	,
	42470747	,
	12565726	,
	6921986	,
	42470497	,
	23349678	,
	42471089	,
	24053870	,
	45523046	,
	41644447	,
	6630761	,
	6631523	,
	6632498	,
	2083372	,
	41639753	,
	24563085	,
	2083297	,
	6632482	,
	35115515	,
	17034692	,
	24219652	,
	24219928	,
	26903875	,
	2075317	,
	2070817	,
	23458438	,
	32294647	,
	28160728) AND propagatefrombookkey IS NOT NULL
	
  OPEN work_cur
  FETCH NEXT FROM work_cur INTO @v_bookkey_from, @v_bookkey_to
  WHILE (@@FETCH_STATUS <> -1) BEGIN
    EXECUTE copy_work_info @v_bookkey_from,@v_bookkey_to,'bookkeywords','keyword'

    SELECT @error_var = @@ERROR, @rowcount_var = @@ROWCOUNT
    IF @error_var <> 0 BEGIN
      SET @v_error_desc = 'error executing stored procedure copy_work_info: bookkey from = ' + cast(@v_bookkey_from AS VARCHAR) + 
                          ' bookkey to = ' + cast(@v_bookkey_to AS VARCHAR) +
                          ' tablename = bookkeywords' + 
                          ' columnname = keyword' 
    END 

    FETCH NEXT FROM work_cur INTO @v_bookkey_from, @v_bookkey_to
  END

  CLOSE work_cur
  DEALLOCATE work_cur	